# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

YourDigits is a Flutter personal finance app exported from FlutterFlow, designed to track spending, manage accounts, and budget using a "jars" metaphor. The app uses Supabase as the backend database and Firebase for performance monitoring.

## Development Commands

### Building and Running
- `flutter run` - Run the app in debug mode
- `flutter run --release` - Run in release mode
- `flutter build apk` - Build Android APK
- `flutter build ios` - Build iOS app
- `flutter build web` - Build web version

### Development Tools  
- `flutter analyze` - Run static analysis (use this for linting)
- `flutter test` - Run unit tests
- `flutter clean` - Clean build artifacts
- `flutter pub get` - Install dependencies
- `flutter pub upgrade` - Update dependencies

### Debugging
- `flutter logs` - View device logs
- `flutter doctor` - Check Flutter installation
- `flutter devices` - List connected devices

## Architecture Overview

### Project Structure
- **`lib/main.dart`** - App entry point, initializes Firebase, Supabase, and app state
- **`lib/app_state.dart`** - Global app state management using ChangeNotifier
- **`lib/flutter_flow/`** - FlutterFlow-generated utilities and widgets
- **`lib/backend/supabase/`** - Database layer with table definitions and queries
- **`lib/auth/`** - Authentication system using Supabase Auth
- **`lib/components/`** - Reusable UI components (drag-and-drop coins, jars, popups)
- **Feature modules** organized by domain:
  - `lib/home_screen/` - Dashboard and summary views
  - `lib/transaction/` - Transaction management
  - `lib/accounts/` - Account management
  - `lib/authentication/` - Login/signup screens
  - `lib/budget/` - Budgeting features

### Key Technologies
- **Flutter SDK**: >=3.0.0 <4.0.0
- **State Management**: Provider pattern with ChangeNotifier
- **Navigation**: GoRouter with declarative routing
- **Backend**: Supabase (PostgreSQL database, auth, real-time)
- **UI Framework**: Material Design (useMaterial3: false)
- **Theming**: Custom FlutterFlow theme system with light/dark mode

### Database Architecture
The app connects to Supabase with these main tables:
- `users` - User profiles and settings
- `accounts` - Financial accounts (checking, savings, etc.)
- `transactions` - Financial transactions
- `categories` - Transaction categories
- `jars` - Budgeting "jars" for the envelope system
- `user_settings` - User preferences

Views are extensively used for data aggregation:
- `v_*_summary` views for spending/saving summaries by period
- `view_account_balances` for current account states
- `v_transactions_active` / `v_accounts_active` for filtered data

### Authentication Flow
- Supabase Auth with email/password and Apple Sign In
- JWT token management with automatic refresh
- Auth state managed through `AppStateNotifier`
- Route protection based on authentication status

### Navigation Pattern
- Declarative routing using GoRouter
- Route definitions in `lib/flutter_flow/nav/nav.dart`
- Auth-aware navigation with redirect logic
- Each screen has static `routeName` and `routePath` properties

### State Management Pattern
- Global state: `FFAppState` singleton using ChangeNotifier
- Page-level state: Each page has a corresponding `*Model` class extending `FlutterFlowModel`
- Widget-level state: Standard StatefulWidget pattern for UI components

### FlutterFlow Integration
This project was generated by FlutterFlow, which means:
- **DO NOT** modify files with "// Generated by FlutterFlow" headers
- Custom code lives in `lib/custom_code/` directory
- FlutterFlow utilities in `lib/flutter_flow/` provide theming, widgets, and navigation helpers
- Assets are organized in the `assets/` directory with specific folder structure

### Custom Components
- `GoldCoinDraggableWidget` - Draggable transaction representation
- `JarDragTargetWidget` - Drop target for budget allocation
- `TransPopUpWidget` - Transaction detail modal

### Common Patterns
- Each screen follows the pattern: `*Widget` (UI) + `*Model` (state/logic)
- Database operations use generated Supabase client with typed row classes
- Form validation using FlutterFlow's validation utilities
- Responsive design using FlutterFlow's breakpoint system

### Database Connection
Supabase configuration is in `lib/backend/supabase/supabase.dart`. The connection uses:
- URL: `https://nmqhhmjjroqdnafbfygd.supabase.co`
- Anonymous key for client-side access
- Row Level Security for data protection

### Asset Management
Assets are organized in subdirectories:
- `assets/fonts/` - Custom fonts
- `assets/images/` - App images and icons  
- `assets/videos/` - Video content
- `assets/rive_animations/` - Rive animation files

### Testing
- Unit tests in `test/` directory
- Widget tests using Flutter's testing framework
- Currently has basic widget_test.dart template